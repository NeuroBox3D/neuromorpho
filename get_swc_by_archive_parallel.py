import os
import joblib
import subprocess 
import argparse


def execute_command(shell_command):
    subprocess.call(shell_command, shell=True)


def execute_commands(shell_commands):
    for shell_command in shell_commands:
        print(shell_command)
        execute_command(shell_command)

def execute_commands_parallel(shell_commands):
    from joblib import Parallel, delayed
    Parallel(n_jobs=os.cpu_count())(delayed(execute_command)(i) for i in shell_commands)
    

def construct_command_per_archive(archive, output_dir):
    return "python3.8 get_swc.py --archive %s --output=%s" % (archive, output_dir)


def main():
    
    parser = argparse.ArgumentParser(description="Parallel access NeuroMorpho.org v8.5 w/ REST API and download SWC files")
    parser.add_argument('--output', required=True, type=str, help="The output directory where the results will be written")
    args = parser.parse_args()
    
    archives = [
        "Abdolhoseini_Kluge",
        "Abrous",
        "Acharya",
        "Achim_Partanen",
        "Acsady",
        "Adke_Carrasquillo",
        "Adori",
        "Aharon_Zuo",
        "Ahmed",
        "Alilain",
        "Allen Cell Types",
        "Allman",
        "Almeida",
        "Almuhtasib",
        "Althammer",
        "Alvarez",
        "Alzheimer",
        "Amaral",
        "Anderson",
        "Andolina",
        "Andreae",
        "Anselmi_Travagli",
        "Anstoetz",
        "Antic",
        "Anton",
        "Araujo",
        "Arenkiel",
        "Argue",
        "Arnold_Johnston",
        "Artinian",
        "Ascoli",
        "Ataman_Boulting",
        "Auer",
        "Avendano",
        "Bacci",
        "Bacigaluppi",
        "Back",
        "Badea",
        "Baharani_A",
        "Baier",
        "Bailey",
        "Baldwin",
        "Balleine",
        "Ballester-Rosado",
        "Baltussen_Ultanir",
        "Bandtlow",
        "Banerjee",
        "Bannatyne",
        "Bao_Hechen",
        "Baptista_Sousa",
        "Barbour",
        "Barco_Scandaglia",
        "Bardy",
        "Bareyre",
        "Baro",
        "Barreda",
        "Barrionuevo",
        "Bartmann",
        "Bartos",
        "Bastian",
        "Bathellier_Larkum",
        "Baulac",
        "Bausch",
        "Bazan",
        "Becchetti",
        "Beck",
        "Beckstead",
        "Beer_Foerster",
        "Beguin",
        "Beining",
        "Bellemer",
        "Bellesi_Zhang",
        "Ben-Ari",
        "Bengochea",
        "Bercier",
        "Bergstrom",
        "Berkowitz",
        "Bertels",
        "Bevan_Chu",
        "Bianchi",
        "Bianco",
        "Bicanic",
        "BICCN-MOp-miniatlas-anatomy",
        "Bikson",
        "Bilkei-Gorzo",
        "Bird",
        "Birinyi",
        "Bito",
        "Blackman",
        "Blackwell",
        "Blagburn",
        "Bleckert",
        "Bock",
        "Boesmans_VandenBerghe",
        "Borst",
        "Bove_Travagli",
        "Boyle",
        "Bragado-Alonso",
        "Brager",
        "Branchereau_Cattaert",
        "Brecha",
        "Brecht",
        "Brennand",
        "Briggman",
        "Briggs",
        "Brown",
        "Browning",
        "Browning_Travagli",
        "Bruckner",
        "Brumberg",
        "Brunjes",
        "Brunner",
        "Bu",
        "Buchs",
        "Buelow",
        "Buffo",
        "Bullmann",
        "Burdakov",
        "Burke",
        "Burkhalter",
        "Buskila",
        "Buzsaki",
        "Bu_Yu",
        "Cai",
        "Caille",
        "Calabresi_Ghiglieri",
        "Calderon",
        "Cameron",
        "Campos",
        "Canavesi",
        "Capogna",
        "Cappelli_Buratti",
        "Cardona",
        "Carlen",
        "Carriba",
        "Carvalho",
        "Castanho_Oliveira",
        "Cauli",
        "Caviedes",
        "Chadderton",
        "Chaimowicz",
        "Chalupa",
        "Chandrashekar",
        "Chang",
        "Chao",
        "Charlet",
        "Chen",
        "Cheng",
        "Chen_B",
        "Chen_D",
        "Chen_Dai",
        "Chen_Dong",
        "Chen_Maniatis",
        "Chen_Qu",
        "Chen_SK",
        "Chen_YP",
        "Chen_Zhao",
        "Chiang",
        "Chklovskii",
        "Chmykhova",
        "Cho",
        "Ciosk",
        "Cirelli",
        "Claiborne",
        "Cline",
        "Coate",
        "Cohen",
        "Cohen-Cory",
        "Cohen_A",
        "Collin",
        "Consiglio",
        "Conte",
        "Conti",
        "Coombes",
        "Cossart",
        "Cox",
        "da Silva",
        "Dahmen",
        "Dallman",
        "Danzer",
        "Daria",
        "Darnell",
        "De Bartolo",
        "De Koninck",
        "De Paola",
        "De Schutter",
        "DeFelipe",
        "Dehorter",
        "deKloet_Mansvelder",
        "DeKock",
        "Del Negro",
        "Delvalle",
        "DeMoya_Morrison",
        "DeMunter",
        "Dendritica",
        "Deng",
        "Denizet",
        "Denk",
        "Destexhe",
        "Dhanya",
        "Di Benedetto",
        "DIADEM",
        "Diana",
        "Dias_Lima",
        "Diaz",
        "Dickstein",
        "DiCristo",
        "Dierssen",
        "DiLisa",
        "Ding_Feldmeyer",
        "Diniz",
        "Djenoune_wyart",
        "Doe",
        "Dolci_Decimo",
        "Dong",
        "Dragich",
        "Drago",
        "Duan",
        "Duch",
        "Dudek",
        "Dumas",
        "Duque-Tahvildari",
        "Dusart",
        "Dwyer",
        "Egger",
        "Eickholt",
        "Ellender",
        "Ellis",
        "Epsztein",
        "Eroglu",
        "Esclapez",
        "Evans",
        "EyeWire",
        "Falcone",
        "Farrow",
        "Faucherre",
        "Feldmeyer",
        "Feller",
        "Fellin",
        "Feng",
        "Ferguson",
        "Fernandez-Acosta_Vicario",
        "Fernandez-Ruiz",
        "Field",
        "Firestein",
        "Fishell",
        "Fisher",
        "Flores",
        "FlyEM",
        "Foerster",
        "Folgueira",
        "Fontana",
        "Franca",
        "Frankland",
        "Franklin",
        "Fricker",
        "Fried",
        "Fujita",
        "Fukunaga",
        "Fulton",
        "Fyffe",
        "Gabbiani",
        "Gage",
        "Gage_Toda",
        "Galliano_Grubb",
        "Galloni_Rancz",
        "Gangras",
        "Garcia",
        "Garcia-Cairasco",
        "Garcia-Hernandez_DeSantis",
        "Gareau",
        "Gartner-Alpar",
        "Gaspar",
        "Gauron",
        "Gazan",
        "Geis_Borst",
        "Gerber",
        "Gesuita_Karayannis",
        "Ghatak_Lipton",
        "Ghosh",
        "Giniger",
        "Ginty",
        "Giugliano",
        "Glennon",
        "GliaLab",
        "Goaillard",
        "Goldman-Rakic",
        "Gomes",
        "Gonzalez-Arenas",
        "Gonzalez-Burgos",
        "Gradinaru",
        "Grasselli",
        "Grasselli_Hansel",
        "Greathouse_Herskowitz",
        "Greggio",
        "Griego_Galvan",
        "Grilli",
        "Groen",
        "Groh",
        "Grtuzendler_Hill",
        "Grunert",
        "Guerra da Rocha",
        "Gugula",
        "Guizzetti",
        "Gulledge",
        "Gulyas",
        "Gunnersen",
        "Guo",
        "Guo_Xia",
        "Gupton_Song",
        "Guthrie",
        "Hajos",
        "Hale",
        "Halnes",
        "Hamad",
        "Hannibal",
        "Han_etal",
        "Harland",
        "Hart",
        "Hay",
        "Hayes",
        "Heistek_Mansvelder",
        "Helmstaedter",
        "Hen",
        "Henckens",
        "Henny",
        "Henny_Roeper",
        "Heppner",
        "Herget",
        "Hernandez-Garzon",
        "Herring_Keyvani",
        "Hess",
        "Hetman",
        "Hierlemann",
        "Higgs",
        "Hildebrand",
        "Hioki",
        "Hirsch",
        "Hoffman",
        "Hof_Varghese",
        "Howard",
        "Hoxha",
        "Hrvoj-Mihic_Semendeferi",
        "Hsueh",
        "Huang",
        "Huang_JY",
        "Huang_ML",
        "Huang_ZJ",
        "Huberman",
        "Huber_Haapasalo",
        "Huebener",
        "Hughes",
        "Huh",
        "Hunt",
        "Hur",
        "Hurd",
        "HustTDI",
        "Huynh",
        "Hu_Cheng_Soba",
        "Hu_Soba",
        "Hwang",
        "Hyunsoo",
        "H_Zhang",
        "Iascone",
        "Igarashi",
        "Ikeno",
        "Illiano_Pardo",
        "Imai",
        "Irintchev",
        "Isaacson",
        "Issa_Schwalbe",
        "Ito",
        "Jaarsma",
        "Jacobs",
        "Jacobs_G",
        "Jacoby_Schwartz",
        "Jaeger",
        "Jaffe",
        "Jan",
        "Jefferis",
        "Jekely",
        "Jensen",
        "Jiezheng",
        "Johenning",
        "Johnson",
        "Johnson_T",
        "Johnston",
        "Johnston_J",
        "Jonas",
        "Jongbloets",
        "Jubao_Forrest",
        "Kabbani",
        "Kadow",
        "Kameda_Kaneko",
        "Kamikouchi",
        "Kanatsou",
        "Kana_Desland",
        "Kannan",
        "Kanninen",
        "Kantor",
        "Kantor_Szarka",
        "Karaca_Oliveira",
        "Karlsson",
        "Karube",
        "Katona",
        "Kavetsky",
        "Kawaguchi",
        "Ka_Kim",
        "Kellendonk",
        "Keller",
        "Kelliher",
        "Kengaku",
        "Keyvani",
        "Khankan",
        "Khodosevich",
        "Kilb",
        "Kim",
        "Kimura",
        "Kimura_Tohyama",
        "Kim_JH",
        "King",
        "Kist",
        "Kisvarday",
        "Kiyota_Machhi",
        "Klatt_Heine",
        "Klausberger",
        "Kodali_Shetty",
        "Koehl",
        "Kojic",
        "Kole",
        "Kondo",
        "Kononenko_Haucke",
        "Kontou_Kittler",
        "Kornfeld",
        "Korngreen",
        "Korte",
        "Koshy",
        "Kosillo",
        "Kosillo_Ahmed",
        "Kosta_Jones",
        "Kougias_Juraska",
        "Krajka",
        "Kramvis_Spijker",
        "Krasnoshchekova",
        "Krieger",
        "Krishnaswamy",
        "Kroon",
        "Kuan_Phelps",
        "Kubota",
        "Kuddannaya",
        "Kula_Gugula",
        "Kullander",
        "La Barbera",
        "Lagali",
        "Lagartos-Donate",
        "Lai",
        "Lambe",
        "Landgraf",
        "Lanoue",
        "Larkman",
        "Lasik",
        "Laukoter_Hippenmeyer",
        "Laurent",
        "Lee",
        "Lee_CH",
        "Lee_CJ",
        "Lee_KH",
        "Lee_LJ",
        "Lefler_Amsalem",
        "Lein",
        "Leroy",
        "Levkowitz",
        "Lewis",
        "Liao",
        "Lien",
        "Lim_Kitazawa",
        "Lin",
        "Linaro",
        "Linyi_Chen",
        "Lin_Zhang",
        "Liu",
        "Liu_XD",
        "Liu_Zeng",
        "Li_Bolshakov",
        "Li_Yao",
        "Loane",
        "Lohr",
        "Long",
        "Lopes",
        "Lopez-Bendito",
        "Lopez-Schier",
        "Lorenzati",
        "Lovell",
        "Lozano",
        "Luders",
        "Luebke",
        "Luikart",
        "Lukas",
        "Lumpkin",
        "Luo",
        "Luzzati",
        "Lu_Lichtman",
        "Ma",
        "MacAskill",
        "Maccaferri",
        "MacDonald",
        "Macedo-Lima",
        "Madeira_Tsirka",
        "Maguire-Zeiss",
        "Mailly",
        "Makihara_Goshima",
        "Mallick",
        "Mancia-Leon",
        "Manis",
        "Mani_Schwartz",
        "Manzini",
        "Maras_Akil",
        "Marder",
        "Margrie",
        "Marin",
        "Markram",
        "Martemyanov",
        "Martin",
        "Martina",
        "Martineau",
        "Martin_Avendano",
        "Martone",
        "Masachs",
        "Masland",
        "Maxwell",
        "Ma_Pan",
        "Ma_Serra",
        "McBain",
        "McKellar",
        "McQuiston",
        "Mearow",
        "Mechawar",
        "Medalla",
        "Medan",
        "Mehder",
        "Meliza",
        "Mellor",
        "Mena-Segovia",
        "Mentis",
        "Mercer",
        "Merchan-Perez",
        "Mercuri",
        "Meszena",
        "Meucci",
        "Meyer",
        "Michaelson",
        "Middei_Minichiello",
        "Middledorp",
        "Mikhaylova",
        "Miller",
        "Miller_Allison",
        "Milnerwood",
        "Miroschnikow",
        "Miyasaka",
        "Mizrahi",
        "Molinard-Chenu",
        "Molofsky",
        "Montgomery_Masino",
        "Monyer",
        "Moons",
        "Morara",
        "Morelli",
        "Morgan",
        "Morimoto_Zhao_Reiser",
        "Morrice",
        "Morrow",
        "Morsch",
        "MouseLight",
        "Moyer",
        "Mueller_Chen",
        "Mulholland",
        "Munera",
        "Munoz-Cobo",
        "Muotri",
        "Murase",
        "Murer",
        "Mustaparta_Lofaldli",
        "Nacher",
        "Naegele",
        "Nagaeva_Korpi",
        "Nakano_Doya",
        "Namiki",
        "Nam_Yu",
        "Nandi",
        "Narkilahti",
        "Nath",
        "Nathans",
        "Nath_Schwartz",
        "Nedelescu",
        "Nedelescu-Aoki",
        "Negyessy",
        "Nelson",
        "Neves",
        "Newbern",
        "Ngodup_Trussel",
        "Niquille",
        "Nishitoh",
        "Nishiyama",
        "Nixdorf-Bergweiler",
        "Nolan",
        "Nombela-Palomo",
        "Nordman",
        "Norkett",
        "Northington",
        "Nusser",
        "Oboti",
        "Oguro-Ando",
        "Ohgomori",
        "Olesnicky",
        "Oliveira",
        "Oliveira_Neumann",
        "Olson",
        "OpenWorm",
        "Opitz",
        "Orion",
        "Orlowski",
        "Ortega",
        "Otsuka",
        "Otto",
        "Oviedo",
        "Ozaki",
        "Pal",
        "Palmer",
        "Pantelis_Mann",
        "Papageorgiou_Kann",
        "Papazian",
        "Pappas_Dauer",
        "Park",
        "Parker",
        "Park_Smirnakis",
        "Parnas",
        "Pascucci",
        "Patterson_Neitz",
        "Pearlstein_Hammond",
        "Peca",
        "Peng",
        "Peng_YR",
        "Peric_Bataveljic",
        "Petersen",
        "Peterson",
        "Petreanu",
        "Petrosini",
        "Pham",
        "Pierce",
        "Piirainen",
        "Pinto",
        "Pirone",
        "Pischedda_Piccoli",
        "Piskorowski",
        "Pita-Thomas",
        "Poleg-Polsky",
        "Poorthuis",
        "Poria",
        "Portera-Cailliau",
        "Povysheva",
        "Pozzo-Miller",
        "Prida",
        "Prince",
        "Priya",
        "Puglielli",
        "Pushchin",
        "Putatunda_Hu",
        "Qiru",
        "Qiu",
        "Qu",
        "Quan",
        "Quinlan",
        "Radic",
        "Radley",
        "Rainnie",
        "Rajamani_Qvist",
        "Raju_Oldham",
        "Rancillac",
        "Rancz",
        "Rasia-Filho",
        "Razetti",
        "Reiser",
        "Ren",
        "Renner",
        "Rhode",
        "Ribic",
        "Rice-Baylor",
        "Richards",
        "Rico",
        "Rieger",
        "Riera-Tur",
        "Rishal",
        "Rivlin",
        "Robel",
        "Roberts",
        "Rochefort",
        "Rockland",
        "Rodger",
        "Rodrigues",
        "Rodrigues_Sousa_Cunha",
        "Rose",
        "Rosenberg",
        "Rosenkranz",
        "Rosner",
        "Rossi",
        "Routh",
        "Roysam",
        "Rubel",
        "Rudy",
        "Ruiyu",
        "Rumbaugh",
        "Rusakov",
        "Ruthazer",
        "Rybak_Knaden",
        "Sachse",
        "Saghatelyan",
        "Sailor",
        "Sakalar_Lasztoczi",
        "Sanes",
        "Santhakumar",
        "Sanz-Morello",
        "Sato-Bigbee",
        "Sawtell",
        "Scanziani",
        "Schmitz",
        "Schoppik_Schier",
        "Schornig_Taverna",
        "Schulz",
        "Schwaller",
        "Schwartz",
        "Scimemi",
        "Scott",
        "Se-Jun",
        "Segev",
        "Seki",
        "Sekulic",
        "Sell",
        "Selten_Kasri",
        "Semendeferi_Muotri",
        "Sengelaub",
        "Serra_Colasante",
        "Seung",
        "Shah_Bamji",
        "Shao_Chen",
        "Shcheglovitov",
        "Sheets",
        "Shimell",
        "Shinomiya_FlyEM",
        "Siegelbaum",
        "Siegert",
        "Siemsen",
        "Sikdar",
        "Singh",
        "Singh_K",
        "Siqueira_Guil",
        "Sitaraman",
        "Si_Wang",
        "Sjostrom",
        "Skalecka",
        "Skiteva_Chergui",
        "Skyberg",
        "Smart",
        "Smit-Rigter",
        "Smith",
        "Smith-Cowan",
        "Smith_Bilbo",
        "Smith_Cowan",
        "Smith_Koizumi",
        "Sng",
        "Soba",
        "Soltesz",
        "Somogyi",
        "Sondereker_Renna",
        "Soriano",
        "Southam",
        "Spiga",
        "Spruston",
        "Sreenath",
        "Stagkourakis_Broberger",
        "Staiger",
        "Stedehouder",
        "Steelman",
        "Steinecke_Taniguchi",
        "Stevens",
        "Stopfer",
        "Storm",
        "Straiker",
        "Strettoi",
        "Stuart",
        "Studer",
        "Sturner_Tavosanis",
        "Su",
        "Sully_Delogu",
        "Summavielle",
        "Sun",
        "SungBae",
        "Sun_Prince",
        "Suter_Shepherd",
        "Suzuki_Dityatev",
        "Svoboda",
        "Swanson",
        "Sweedler",
        "Sweet",
        "Szatko_Franke",
        "Szegedi",
        "Szegedi_Lamsa",
        "Szegedi_Paizs_Lamsa",
        "Szoboszlay",
        "Sztarker",
        "Szucs",
        "Tagawa",
        "Takahashi",
        "Takeuchi",
        "Tamas",
        "Tang-Schomer",
        "Tan_Ng",
        "Tao",
        "Tarusawa",
        "Tavakoli",
        "Taylor",
        "Tejos-Bravo_Fiedler",
        "Temereva",
        "Tendulkar",
        "Tenner",
        "Tensaouti",
        "Tepper",
        "Tessarollo_Yanpallewar",
        "Thier",
        "Thomas",
        "TieYuan_Zhang",
        "Timofeev",
        "Tischfield",
        "Tobin_Lee",
        "Todd",
        "Tolias",
        "Tolias_Jiang",
        "Topolnik",
        "Tracey",
        "Travagli",
        "Trudeau",
        "Trullas",
        "Tsirka",
        "Tsoulfas",
        "Turner",
        "Ullian",
        "Urban",
        "Urban_K",
        "Usiello",
        "Uteshev",
        "Uusisaari",
        "Vaasjo",
        "Vaidya",
        "Valero_Malva",
        "Valiante",
        "Valley",
        "Vandenbroucke",
        "vanderVoet_Castells",
        "VanDerZee",
        "VanHook",
        "Vannini",
        "Vannini_Restani_Caleo",
        "vanWoerden",
        "Varela-Nallar",
        "vdHeuvel",
        "Ventura",
        "Venugopal_Travers",
        "Vervaeke",
        "Vicini",
        "Vida",
        "Vidal",
        "VilaVerde",
        "Vissel",
        "Vitriol",
        "Vivinetto_Cave",
        "Vlachos",
        "vonEngelhardt",
        "VonGersdorff",
        "vonWyl_vomBerg",
        "Votruba",
        "Vuksic",
        "Wadiche",
        "Wake",
        "Wallace_Palmer",
        "Wang",
        "Wang_Hadjab",
        "Wang_I-F",
        "Wang_J",
        "Wang_Lefebvre",
        "Wang_Maas",
        "Wang_Olson",
        "Wang_XD",
        "Wang_Y",
        "Wang_Ye",
        "Wang_Zhou",
        "Wanner_Friedrich",
        "Watt",
        "Wearne_Hof",
        "Weigel",
        "Weil",
        "Weir",
        "Weiss_Manzini",
        "Wellman",
        "Wenzel_Berman",
        "Wernig",
        "Wernitznig",
        "West",
        "Weston",
        "West_Hofer",
        "Whiddon_Krimm",
        "White",
        "Wildenberg_Kasthuri",
        "Williams",
        "Williams_Wilson",
        "Wilson_R",
        "Wittner",
        "Wolf",
        "Wong",
        "Wong_H",
        "Wong_Silver",
        "Wotjak",
        "Wright_Heuckeroth",
        "Wu",
        "Wu_Yu",
        "Xiong",
        "Xue",
        "Yamada",
        "Yamao",
        "Yamawaki",
        "Yang",
        "Yang-CY",
        "Yang_CY",
        "Yang_Liu",
        "Yang_XW",
        "Yayon_Soreq",
        "Ye",
        "Yen_Chen",
        "Yin",
        "Yin_Yuan",
        "Yorek",
        "Yousheng",
        "Yu",
        "Yuan",
        "Yuste",
        "Yu_Wong",
        "Zagreb",
        "Zaitsev",
        "Zamboni_Merlo",
        "Zeiser",
        "Zeng",
        "Zhang",
        "Zhang_Hu",
        "Zhang_Jiang",
        "Zhang_L",
        "Zhang_S",
        "Zhang_X",
        "Zhan_Kipp",
        "Zhao",
        "Zhao_Yuan",
        "Zheng",
        "Zhong_Mao_Ganguli",
        "Zhou",
        "Zhou_Heijnen",
        "Zhuang",
        "Ziegler_Tavosanis",
        "Zoghbi",
        "Zorrilla_Bacci",
        "Zwart",
        "Zylbertal"
    ]
    
    commands = list()
    for archive in archives:
        commands.append(construct_command_per_archive(archive=archive, output_dir=args.output))
    execute_commands_parallel(shell_commands=commands)

if __name__ == "__main__":
    main()